train_emotion_classifier.py:73: FutureWarning: Method .as_matrix will be removed in a future version. Use .values instead.
  emotions = pd.get_dummies(data['emotion']).as_matrix()
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
Train on 28709 samples, validate on 7178 samples
Epoch 1/10
2019-05-03 18:19:51.581386: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-05-03 18:19:51.704736: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-05-03 18:19:51.707090: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x25f1600 executing computations on platform CUDA. Devices:
2019-05-03 18:19:51.707131: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): Tesla K80, Compute Capability 3.7
2019-05-03 18:19:51.710985: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2200000000 Hz
2019-05-03 18:19:51.711900: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x1d52240 executing computations on platform Host. Devices:
2019-05-03 18:19:51.711952: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-05-03 18:19:51.712404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:00:05.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2019-05-03 18:19:51.712508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2019-05-03 18:19:51.713920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-05-03 18:19:51.713957: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2019-05-03 18:19:51.713973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2019-05-03 18:19:51.714335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10802 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:05.0, compute capability: 3.7)
2019-05-03 18:19:52.692478: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.10.0 locally
   32/28709 [..............................] - ETA: 29:24 - loss: 11.3954 - acc: 0.0938  192/28709 [..............................] - ETA: 5:01 - loss: 13.4841 - acc: 0.1302   352/28709 [..............................] - ETA: 2:48 - loss: 13.4450 - acc: 0.1477  512/28709 [..............................] - ETA: 1:58 - loss: 13.4304 - acc: 0.1543  640/28709 [..............................] - ETA: 1:36 - loss: 13.4391 - acc: 0.1562  800/28709 [..............................] - ETA: 1:18 - loss: 13.4309 - acc: 0.1588  960/28709 [>.............................] - ETA: 1:06 - loss: 13.5430 - acc: 0.1531 1120/28709 [>.............................] - ETA: 58s - loss: 13.5079 - acc: 0.1562  1280/28709 [>.............................] - ETA: 51s - loss: 13.4312 - acc: 0.1617 1440/28709 [>.............................] - ETA: 46s - loss: 13.4611 - acc: 0.1604 1600/28709 [>.............................] - ETA: 42s - loss: 13.4045 - acc: 0.1644 1760/28709 [>.............................] - ETA: 39s - loss: 13.3672 - acc: 0.1670 1920/28709 [=>............................] - ETA: 36s - loss: 13.4118 - acc: 0.1646 2080/28709 [=>............................] - ETA: 34s - loss: 13.4030 - acc: 0.1654 2240/28709 [=>............................] - ETA: 32s - loss: 13.4458 - acc: 0.1629 2400/28709 [=>............................] - ETA: 30s - loss: 13.4829 - acc: 0.1608 2560/28709 [=>............................] - ETA: 29s - loss: 13.5091 - acc: 0.1594 2720/28709 [=>............................] - ETA: 27s - loss: 13.5441 - acc: 0.1574 2912/28709 [==>...........................] - ETA: 26s - loss: 13.5588 - acc: 0.1566 3072/28709 [==>...........................] - ETA: 25s - loss: 13.5557 - acc: 0.1569 3232/28709 [==>...........................] - ETA: 24s - loss: 13.5279 - acc: 0.1587 3392/28709 [==>...........................] - ETA: 23s - loss: 13.5266 - acc: 0.1589 3552/28709 [==>...........................] - ETA: 22s - loss: 13.5117 - acc: 0.1599 3712/28709 [==>...........................] - ETA: 21s - loss: 13.5155 - acc: 0.1598 3872/28709 [===>..........................] - ETA: 21s - loss: 13.5065 - acc: 0.1604 4032/28709 [===>..........................] - ETA: 20s - loss: 13.4822 - acc: 0.1620 4192/28709 [===>..........................] - ETA: 19s - loss: 13.4521 - acc: 0.1639 4352/28709 [===>..........................] - ETA: 19s - loss: 13.4464 - acc: 0.1643 4544/28709 [===>..........................] - ETA: 18s - loss: 13.4210 - acc: 0.1659 4704/28709 [===>..........................] - ETA: 18s - loss: 13.3996 - acc: 0.1673 4864/28709 [====>.........................] - ETA: 17s - loss: 13.3631 - acc: 0.1696 5024/28709 [====>.........................] - ETA: 17s - loss: 13.3803 - acc: 0.1686 5184/28709 [====>.........................] - ETA: 16s - loss: 13.3808 - acc: 0.1686 5376/28709 [====>.........................] - ETA: 16s - loss: 13.3557 - acc: 0.1702 5568/28709 [====>.........................] - ETA: 15s - loss: 13.3786 - acc: 0.1688 5760/28709 [=====>........................] - ETA: 15s - loss: 13.3803 - acc: 0.1688 5920/28709 [=====>........................] - ETA: 15s - loss: 13.3672 - acc: 0.1696 6112/28709 [=====>........................] - ETA: 14s - loss: 13.3666 - acc: 0.1697 6272/28709 [=====>........................] - ETA: 14s - loss: 13.3777 - acc: 0.1690 6432/28709 [=====>........................] - ETA: 14s - loss: 13.3882 - acc: 0.1684 6592/28709 [=====>........................] - ETA: 13s - loss: 13.3933 - acc: 0.1681 6752/28709 [======>.......................] - ETA: 13s - loss: 13.4054 - acc: 0.1674 6944/28709 [======>.......................] - ETA: 13s - loss: 13.3945 - acc: 0.1681 7104/28709 [======>.......................] - ETA: 13s - loss: 13.3969 - acc: 0.1679 7296/28709 [======>.......................] - ETA: 12s - loss: 13.4155 - acc: 0.1668 7488/28709 [======>.......................] - ETA: 12s - loss: 13.4116 - acc: 0.1671 7648/28709 [======>.......................] - ETA: 12s - loss: 13.4092 - acc: 0.1672 7808/28709 [=======>......................] - ETA: 12s - loss: 13.4069 - acc: 0.1674 8000/28709 [=======>......................] - ETA: 11s - loss: 13.4095 - acc: 0.1673 8192/28709 [=======>......................] - ETA: 11s - loss: 13.4179 - acc: 0.1667 8352/28709 [=======>......................] - ETA: 11s - loss: 13.4156 - acc: 0.1669 8544/28709 [=======>......................] - ETA: 11s - loss: 13.4178 - acc: 0.1668 8736/28709 [========>.....................] - ETA: 10s - loss: 13.4218 - acc: 0.1666 8928/28709 [========>.....................] - ETA: 10s - loss: 13.4130 - acc: 0.1671 9120/28709 [========>.....................] - ETA: 10s - loss: 13.4187 - acc: 0.1668 9312/28709 [========>.....................] - ETA: 10s - loss: 13.4242 - acc: 0.1665 9504/28709 [========>.....................] - ETA: 10s - loss: 13.4311 - acc: 0.1660 9696/28709 [=========>....................] - ETA: 9s - loss: 13.4311 - acc: 0.1660  9856/28709 [=========>....................] - ETA: 9s - loss: 13.4420 - acc: 0.1654 9984/28709 [=========>....................] - ETA: 9s - loss: 13.4392 - acc: 0.165610176/28709 [=========>....................] - ETA: 9s - loss: 13.4216 - acc: 0.166710336/28709 [=========>....................] - ETA: 9s - loss: 13.4353 - acc: 0.165810496/28709 [=========>....................] - ETA: 9s - loss: 13.4301 - acc: 0.166210688/28709 [==========>...................] - ETA: 9s - loss: 13.4392 - acc: 0.165610848/28709 [==========>...................] - ETA: 9s - loss: 13.4401 - acc: 0.165611008/28709 [==========>...................] - ETA: 8s - loss: 13.4424 - acc: 0.165411168/28709 [==========>...................] - ETA: 8s - loss: 13.4447 - acc: 0.165311360/28709 [==========>...................] - ETA: 8s - loss: 13.4402 - acc: 0.165611552/28709 [===========>..................] - ETA: 8s - loss: 13.4401 - acc: 0.165611744/28709 [===========>..................] - ETA: 8s - loss: 13.4454 - acc: 0.165311936/28709 [===========>..................] - ETA: 8s - loss: 13.4398 - acc: 0.165612128/28709 [===========>..................] - ETA: 8s - loss: 13.4476 - acc: 0.165212320/28709 [===========>..................] - ETA: 7s - loss: 13.4500 - acc: 0.165012512/28709 [============>.................] - ETA: 7s - loss: 13.4433 - acc: 0.165412672/28709 [============>.................] - ETA: 7s - loss: 13.4402 - acc: 0.165612864/28709 [============>.................] - ETA: 7s - loss: 13.4426 - acc: 0.165513056/28709 [============>.................] - ETA: 7s - loss: 13.4362 - acc: 0.165913216/28709 [============>.................] - ETA: 7s - loss: 13.4309 - acc: 0.166213408/28709 [=============>................] - ETA: 7s - loss: 13.4345 - acc: 0.166013600/28709 [=============>................] - ETA: 7s - loss: 13.4309 - acc: 0.166313760/28709 [=============>................] - ETA: 6s - loss: 13.4247 - acc: 0.166613920/28709 [=============>................] - ETA: 6s - loss: 13.4278 - acc: 0.166514080/28709 [=============>................] - ETA: 6s - loss: 13.4332 - acc: 0.166114272/28709 [=============>................] - ETA: 6s - loss: 13.4377 - acc: 0.165814464/28709 [==============>...............] - ETA: 6s - loss: 13.4354 - acc: 0.166014656/28709 [==============>...............] - ETA: 6s - loss: 13.4277 - acc: 0.166514848/28709 [==============>...............] - ETA: 6s - loss: 13.4212 - acc: 0.166915008/28709 [==============>...............] - ETA: 6s - loss: 13.4263 - acc: 0.166615168/28709 [==============>...............] - ETA: 6s - loss: 13.4292 - acc: 0.166415360/28709 [===============>..............] - ETA: 5s - loss: 13.4261 - acc: 0.166615552/28709 [===============>..............] - ETA: 5s - loss: 13.4282 - acc: 0.166515712/28709 [===============>..............] - ETA: 5s - loss: 13.4310 - acc: 0.166315904/28709 [===============>..............] - ETA: 5s - loss: 13.4422 - acc: 0.165616096/28709 [===============>..............] - ETA: 5s - loss: 13.4441 - acc: 0.165516288/28709 [================>.............] - ETA: 5s - loss: 13.4340 - acc: 0.166116448/28709 [================>.............] - ETA: 5s - loss: 13.4317 - acc: 0.166316640/28709 [================>.............] - ETA: 5s - loss: 13.4278 - acc: 0.166516832/28709 [================>.............] - ETA: 5s - loss: 13.4240 - acc: 0.166816992/28709 [================>.............] - ETA: 5s - loss: 13.4219 - acc: 0.166917184/28709 [================>.............] - ETA: 4s - loss: 13.4070 - acc: 0.167817376/28709 [=================>............] - ETA: 4s - loss: 13.4017 - acc: 0.168217536/28709 [=================>............] - ETA: 4s - loss: 13.4026 - acc: 0.168117696/28709 [=================>............] - ETA: 4s - loss: 13.4007 - acc: 0.168217888/28709 [=================>............] - ETA: 4s - loss: 13.4101 - acc: 0.167718080/28709 [=================>............] - ETA: 4s - loss: 13.4103 - acc: 0.167618240/28709 [==================>...........] - ETA: 4s - loss: 13.4129 - acc: 0.167518432/28709 [==================>...........] - ETA: 4s - loss: 13.4139 - acc: 0.167418624/28709 [==================>...........] - ETA: 4s - loss: 13.4124 - acc: 0.167518784/28709 [==================>...........] - ETA: 4s - loss: 13.4105 - acc: 0.167618976/28709 [==================>...........] - ETA: 4s - loss: 13.4108 - acc: 0.167619168/28709 [===================>..........] - ETA: 4s - loss: 13.4152 - acc: 0.167419360/28709 [===================>..........] - ETA: 3s - loss: 13.4203 - acc: 0.167019552/28709 [===================>..........] - ETA: 3s - loss: 13.4229 - acc: 0.166919712/28709 [===================>..........] - ETA: 3s - loss: 13.4227 - acc: 0.166919904/28709 [===================>..........] - ETA: 3s - loss: 13.4171 - acc: 0.167320096/28709 [===================>..........] - ETA: 3s - loss: 13.4125 - acc: 0.167520288/28709 [====================>.........] - ETA: 3s - loss: 13.4119 - acc: 0.167620480/28709 [====================>.........] - ETA: 3s - loss: 13.4113 - acc: 0.167620672/28709 [====================>.........] - ETA: 3s - loss: 13.4161 - acc: 0.167320864/28709 [====================>.........] - ETA: 3s - loss: 13.4147 - acc: 0.167421056/28709 [=====================>........] - ETA: 3s - loss: 13.4195 - acc: 0.167121248/28709 [=====================>........] - ETA: 3s - loss: 13.4105 - acc: 0.167721440/28709 [=====================>........] - ETA: 2s - loss: 13.4039 - acc: 0.168121632/28709 [=====================>........] - ETA: 2s - loss: 13.3989 - acc: 0.168421824/28709 [=====================>........] - ETA: 2s - loss: 13.3948 - acc: 0.168722016/28709 [======================>.......] - ETA: 2s - loss: 13.3936 - acc: 0.168722208/28709 [======================>.......] - ETA: 2s - loss: 13.3925 - acc: 0.168822400/28709 [======================>.......] - ETA: 2s - loss: 13.3950 - acc: 0.168722592/28709 [======================>.......] - ETA: 2s - loss: 13.3975 - acc: 0.168522784/28709 [======================>.......] - ETA: 2s - loss: 13.3992 - acc: 0.168422944/28709 [======================>.......] - ETA: 2s - loss: 13.4020 - acc: 0.168223104/28709 [=======================>......] - ETA: 2s - loss: 13.4006 - acc: 0.168323296/28709 [=======================>......] - ETA: 2s - loss: 13.4015 - acc: 0.168323488/28709 [=======================>......] - ETA: 2s - loss: 13.3949 - acc: 0.168723680/28709 [=======================>......] - ETA: 1s - loss: 13.3959 - acc: 0.168623872/28709 [=======================>......] - ETA: 1s - loss: 13.3962 - acc: 0.168624064/28709 [========================>.....] - ETA: 1s - loss: 13.3978 - acc: 0.168524256/28709 [========================>.....] - ETA: 1s - loss: 13.3967 - acc: 0.168624448/28709 [========================>.....] - ETA: 1s - loss: 13.3996 - acc: 0.168424608/28709 [========================>.....] - ETA: 1s - loss: 13.4016 - acc: 0.168324800/28709 [========================>.....] - ETA: 1s - loss: 13.4005 - acc: 0.168324992/28709 [=========================>....] - ETA: 1s - loss: 13.3988 - acc: 0.168525184/28709 [=========================>....] - ETA: 1s - loss: 13.3984 - acc: 0.168525376/28709 [=========================>....] - ETA: 1s - loss: 13.3993 - acc: 0.168425568/28709 [=========================>....] - ETA: 1s - loss: 13.4046 - acc: 0.168125760/28709 [=========================>....] - ETA: 1s - loss: 13.4048 - acc: 0.168125952/28709 [==========================>...] - ETA: 1s - loss: 13.4063 - acc: 0.168026112/28709 [==========================>...] - ETA: 1s - loss: 13.4062 - acc: 0.168026272/28709 [==========================>...] - ETA: 0s - loss: 13.4012 - acc: 0.168326432/28709 [==========================>...] - ETA: 0s - loss: 13.4012 - acc: 0.168326592/28709 [==========================>...] - ETA: 0s - loss: 13.4006 - acc: 0.168426784/28709 [==========================>...] - ETA: 0s - loss: 13.4038 - acc: 0.168226976/28709 [===========================>..] - ETA: 0s - loss: 13.4070 - acc: 0.168027168/28709 [===========================>..] - ETA: 0s - loss: 13.4030 - acc: 0.168227360/28709 [===========================>..] - ETA: 0s - loss: 13.4009 - acc: 0.168327552/28709 [===========================>..] - ETA: 0s - loss: 13.4040 - acc: 0.168227712/28709 [===========================>..] - ETA: 0s - loss: 13.4046 - acc: 0.168127904/28709 [============================>.] - ETA: 0s - loss: 13.4048 - acc: 0.168128064/28709 [============================>.] - ETA: 0s - loss: 13.4053 - acc: 0.168128256/28709 [============================>.] - ETA: 0s - loss: 13.4095 - acc: 0.167828416/28709 [============================>.] - ETA: 0s - loss: 13.4066 - acc: 0.168028608/28709 [============================>.] - ETA: 0s - loss: 13.4062 - acc: 0.1680