train_emotion_classifier.py:73: FutureWarning: Method .as_matrix will be removed in a future version. Use .values instead.
  emotions = pd.get_dummies(data['emotion']).as_matrix()
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
Train on 28709 samples, validate on 7178 samples
Epoch 1/20
2019-05-03 16:59:53.596736: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-05-03 16:59:54.194877: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-05-03 16:59:54.196287: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x2abc260 executing computations on platform CUDA. Devices:
2019-05-03 16:59:54.196323: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): Tesla K80, Compute Capability 3.7
2019-05-03 16:59:54.199437: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2200000000 Hz
2019-05-03 16:59:54.199971: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x2c47590 executing computations on platform Host. Devices:
2019-05-03 16:59:54.200007: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-05-03 16:59:54.200801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:00:05.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2019-05-03 16:59:54.200842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2019-05-03 16:59:54.221344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-05-03 16:59:54.221382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2019-05-03 16:59:54.221398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2019-05-03 16:59:54.221808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10802 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:05.0, compute capability: 3.7)
2019-05-03 16:59:55.434443: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.10.0 locally
   32/28709 [..............................] - ETA: 3:50:34 - loss: 1.9954 - acc: 0.0938  128/28709 [..............................] - ETA: 57:39 - loss: 1.9552 - acc: 0.2109    224/28709 [..............................] - ETA: 32:57 - loss: 1.9096 - acc: 0.2366  320/28709 [..............................] - ETA: 23:04 - loss: 1.8799 - acc: 0.2531  448/28709 [..............................] - ETA: 16:28 - loss: 1.8663 - acc: 0.2634  576/28709 [..............................] - ETA: 12:48 - loss: 1.8551 - acc: 0.2691  704/28709 [..............................] - ETA: 10:28 - loss: 1.8544 - acc: 0.2670  832/28709 [..............................] - ETA: 8:51 - loss: 1.8578 - acc: 0.2536   960/28709 [>.............................] - ETA: 7:39 - loss: 1.8529 - acc: 0.2458 1088/28709 [>.............................] - ETA: 6:45 - loss: 1.8480 - acc: 0.2454 1216/28709 [>.............................] - ETA: 6:02 - loss: 1.8397 - acc: 0.2516 1344/28709 [>.............................] - ETA: 5:27 - loss: 1.8372 - acc: 0.2545 1472/28709 [>.............................] - ETA: 4:58 - loss: 1.8361 - acc: 0.2568 1600/28709 [>.............................] - ETA: 4:34 - loss: 1.8342 - acc: 0.2581 1728/28709 [>.............................] - ETA: 4:13 - loss: 1.8360 - acc: 0.2529 1856/28709 [>.............................] - ETA: 3:56 - loss: 1.8340 - acc: 0.2532 1984/28709 [=>............................] - ETA: 3:40 - loss: 1.8338 - acc: 0.2525 2112/28709 [=>............................] - ETA: 3:27 - loss: 1.8304 - acc: 0.2543 2240/28709 [=>............................] - ETA: 3:15 - loss: 1.8339 - acc: 0.2513 2368/28709 [=>............................] - ETA: 3:04 - loss: 1.8310 - acc: 0.2538 2496/28709 [=>............................] - ETA: 2:54 - loss: 1.8309 - acc: 0.2552 2624/28709 [=>............................] - ETA: 2:45 - loss: 1.8311 - acc: 0.2534 2752/28709 [=>............................] - ETA: 2:37 - loss: 1.8312 - acc: 0.2525 2880/28709 [==>...........................] - ETA: 2:30 - loss: 1.8309 - acc: 0.2517 3008/28709 [==>...........................] - ETA: 2:23 - loss: 1.8304 - acc: 0.2503 3136/28709 [==>...........................] - ETA: 2:17 - loss: 1.8300 - acc: 0.2500 3264/28709 [==>...........................] - ETA: 2:12 - loss: 1.8282 - acc: 0.2472 3392/28709 [==>...........................] - ETA: 2:07 - loss: 1.8298 - acc: 0.2468 3520/28709 [==>...........................] - ETA: 2:02 - loss: 1.8293 - acc: 0.2472 3648/28709 [==>...........................] - ETA: 1:57 - loss: 1.8279 - acc: 0.2478 3776/28709 [==>...........................] - ETA: 1:53 - loss: 1.8283 - acc: 0.2479 3904/28709 [===>..........................] - ETA: 1:49 - loss: 1.8276 - acc: 0.2487 4032/28709 [===>..........................] - ETA: 1:45 - loss: 1.8265 - acc: 0.2498 4160/28709 [===>..........................] - ETA: 1:42 - loss: 1.8257 - acc: 0.2502 4288/28709 [===>..........................] - ETA: 1:39 - loss: 1.8255 - acc: 0.2502 4416/28709 [===>..........................] - ETA: 1:36 - loss: 1.8246 - acc: 0.2509 4544/28709 [===>..........................] - ETA: 1:33 - loss: 1.8243 - acc: 0.2500 4672/28709 [===>..........................] - ETA: 1:30 - loss: 1.8238 - acc: 0.2509 4800/28709 [====>.........................] - ETA: 1:28 - loss: 1.8234 - acc: 0.2510 4928/28709 [====>.........................] - ETA: 1:25 - loss: 1.8222 - acc: 0.2510 5056/28709 [====>.........................] - ETA: 1:23 - loss: 1.8222 - acc: 0.2494 5184/28709 [====>.........................] - ETA: 1:21 - loss: 1.8211 - acc: 0.2494 5312/28709 [====>.........................] - ETA: 1:18 - loss: 1.8210 - acc: 0.2477 5440/28709 [====>.........................] - ETA: 1:16 - loss: 1.8198 - acc: 0.2483 5568/28709 [====>.........................] - ETA: 1:14 - loss: 1.8184 - acc: 0.2495 5696/28709 [====>.........................] - ETA: 1:13 - loss: 1.8175 - acc: 0.2495 5824/28709 [=====>........................] - ETA: 1:11 - loss: 1.8133 - acc: 0.2526 5952/28709 [=====>........................] - ETA: 1:09 - loss: 1.8125 - acc: 0.2525 6080/28709 [=====>........................] - ETA: 1:07 - loss: 1.8109 - acc: 0.2530 6208/28709 [=====>........................] - ETA: 1:06 - loss: 1.8110 - acc: 0.2539 6336/28709 [=====>........................] - ETA: 1:04 - loss: 1.8084 - acc: 0.2554 6464/28709 [=====>........................] - ETA: 1:03 - loss: 1.8096 - acc: 0.2550 6592/28709 [=====>........................] - ETA: 1:02 - loss: 1.8077 - acc: 0.2567 6720/28709 [======>.......................] - ETA: 1:00 - loss: 1.8062 - acc: 0.2570 6848/28709 [======>.......................] - ETA: 59s - loss: 1.8059 - acc: 0.2574  6976/28709 [======>.......................] - ETA: 58s - loss: 1.8072 - acc: 0.2563 7072/28709 [======>.......................] - ETA: 57s - loss: 1.8068 - acc: 0.2564 7200/28709 [======>.......................] - ETA: 56s - loss: 1.8056 - acc: 0.2582 7328/28709 [======>.......................] - ETA: 54s - loss: 1.8035 - acc: 0.2590 7456/28709 [======>.......................] - ETA: 53s - loss: 1.8019 - acc: 0.2599 7584/28709 [======>.......................] - ETA: 52s - loss: 1.8000 - acc: 0.2611 7712/28709 [=======>......................] - ETA: 51s - loss: 1.7981 - acc: 0.2630 7840/28709 [=======>......................] - ETA: 50s - loss: 1.7952 - acc: 0.2640 7968/28709 [=======>......................] - ETA: 49s - loss: 1.7938 - acc: 0.2643 8064/28709 [=======>......................] - ETA: 49s - loss: 1.7934 - acc: 0.2646 8192/28709 [=======>......................] - ETA: 48s - loss: 1.7927 - acc: 0.2661 8320/28709 [=======>......................] - ETA: 47s - loss: 1.7914 - acc: 0.2661 8448/28709 [=======>......................] - ETA: 46s - loss: 1.7886 - acc: 0.2686 8576/28709 [=======>......................] - ETA: 45s - loss: 1.7869 - acc: 0.2689 8704/28709 [========>.....................] - ETA: 44s - loss: 1.7855 - acc: 0.2698 8832/28709 [========>.....................] - ETA: 43s - loss: 1.7841 - acc: 0.2698 8960/28709 [========>.....................] - ETA: 43s - loss: 1.7841 - acc: 0.2694 9088/28709 [========>.....................] - ETA: 42s - loss: 1.7823 - acc: 0.2705 9216/28709 [========>.....................] - ETA: 41s - loss: 1.7803 - acc: 0.2715 9344/28709 [========>.....................] - ETA: 40s - loss: 1.7809 - acc: 0.2710 9472/28709 [========>.....................] - ETA: 40s - loss: 1.7807 - acc: 0.2713 9600/28709 [=========>....................] - ETA: 39s - loss: 1.7798 - acc: 0.2723 9728/28709 [=========>....................] - ETA: 38s - loss: 1.7783 - acc: 0.2742 9856/28709 [=========>....................] - ETA: 38s - loss: 1.7762 - acc: 0.2753 9984/28709 [=========>....................] - ETA: 37s - loss: 1.7750 - acc: 0.276110112/28709 [=========>....................] - ETA: 36s - loss: 1.7739 - acc: 0.276510240/28709 [=========>....................] - ETA: 36s - loss: 1.7733 - acc: 0.276710368/28709 [=========>....................] - ETA: 35s - loss: 1.7722 - acc: 0.276710496/28709 [=========>....................] - ETA: 35s - loss: 1.7708 - acc: 0.277910624/28709 [==========>...................] - ETA: 34s - loss: 1.7699 - acc: 0.278410752/28709 [==========>...................] - ETA: 34s - loss: 1.7690 - acc: 0.279610880/28709 [==========>...................] - ETA: 33s - loss: 1.7660 - acc: 0.280611008/28709 [==========>...................] - ETA: 33s - loss: 1.7661 - acc: 0.280411136/28709 [==========>...................] - ETA: 32s - loss: 1.7657 - acc: 0.280911264/28709 [==========>...................] - ETA: 32s - loss: 1.7646 - acc: 0.281411392/28709 [==========>...................] - ETA: 31s - loss: 1.7638 - acc: 0.281411520/28709 [===========>..................] - ETA: 31s - loss: 1.7631 - acc: 0.282011648/28709 [===========>..................] - ETA: 30s - loss: 1.7622 - acc: 0.282211776/28709 [===========>..................] - ETA: 30s - loss: 1.7616 - acc: 0.282511904/28709 [===========>..................] - ETA: 29s - loss: 1.7607 - acc: 0.282812032/28709 [===========>..................] - ETA: 29s - loss: 1.7601 - acc: 0.283212160/28709 [===========>..................] - ETA: 28s - loss: 1.7588 - acc: 0.284112288/28709 [===========>..................] - ETA: 28s - loss: 1.7592 - acc: 0.284412416/28709 [===========>..................] - ETA: 27s - loss: 1.7581 - acc: 0.285012544/28709 [============>.................] - ETA: 27s - loss: 1.7579 - acc: 0.285812672/28709 [============>.................] - ETA: 26s - loss: 1.7573 - acc: 0.286212800/28709 [============>.................] - ETA: 26s - loss: 1.7564 - acc: 0.287012928/28709 [============>.................] - ETA: 26s - loss: 1.7557 - acc: 0.286913056/28709 [============>.................] - ETA: 25s - loss: 1.7548 - acc: 0.287613184/28709 [============>.................] - ETA: 25s - loss: 1.7529 - acc: 0.288813312/28709 [============>.................] - ETA: 25s - loss: 1.7537 - acc: 0.288713440/28709 [=============>................] - ETA: 24s - loss: 1.7524 - acc: 0.289313568/28709 [=============>................] - ETA: 24s - loss: 1.7506 - acc: 0.289913696/28709 [=============>................] - ETA: 23s - loss: 1.7493 - acc: 0.290713824/28709 [=============>................] - ETA: 23s - loss: 1.7472 - acc: 0.291713952/28709 [=============>................] - ETA: 23s - loss: 1.7461 - acc: 0.292114080/28709 [=============>................] - ETA: 22s - loss: 1.7452 - acc: 0.293114208/28709 [=============>................] - ETA: 22s - loss: 1.7440 - acc: 0.294014336/28709 [=============>................] - ETA: 22s - loss: 1.7442 - acc: 0.294114464/28709 [==============>...............] - ETA: 21s - loss: 1.7433 - acc: 0.294014592/28709 [==============>...............] - ETA: 21s - loss: 1.7417 - acc: 0.295014720/28709 [==============>...............] - ETA: 21s - loss: 1.7408 - acc: 0.2957